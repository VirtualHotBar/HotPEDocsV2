# 专用文件夹
资源包根目录中会包含一些以 `_` 开头的专用文件夹，此处给出这些文件夹的定义与用途
## 随从文件夹
`_retinue`

将你编写的脚本与主程序分离是很有必要的，这样你可以在主程序有更新时放心地替换主程序目录而不需要担心替换导致的脚本缺失问题。我们指定使用 `_retinue` 文件夹存放你编写的脚本，以及一些可能的额外附件。

通常来说你不需要手动建立这个文件夹，构建工具会扫描所有的 `Script` 类型步骤，然后将被引用的脚本移动至 `_retinue` 文件夹。这只是一个打包的过程，实际加载时脚本的工作目录仍会是资源根目录，因此你大可直接在根目录调试你的脚本，而将这个过程视为黑盒。

不过，由于根目录不允许出现规定内容之外的东西，如果你的脚本引用了一些二进制工具(例如调用 [`jj.exe`](https://github.com/tidwall/jj) 读写 json 文件)或是调用了额外的脚本，那么你需要这样做：

- 在根目录新建 `_retinue` 文件夹，将*需要引用*的工具和脚本移动到 `_retinue` 文件夹内
- 在根目录中编写*由 `Script` 类型步骤直接调用*的脚本，并在其中使用 `.\_retinue\xxx` 调用工具和额外的脚本
- 完成测试后运行构建工具构建资源包

加载器运行时会遍历 `_retinue` 文件夹中的所有脚本文件(`.cmd` `.bat` `.wcs` `.ini`)，将其中的 `.\_retinue\xxx` 引用动态替换为正确的路径，然后再解析工作流，并基于资源根目录直接调用 `_retinue` 文件夹中的脚本。这样可以保证加载时的工作环境与打包前的工作环境基本一致。

:::tip
请注意，只有显式地使用 `.\_retinue\` 的引用才会被动态替换

如果不希望引用被动态替换，请使用 `_retinue\` 或是使用 `cd _retinue` 切换目录后执行命令；通常需要这么做的情况很罕见

类似于 `..\_retinue\` 的写法本身就不应出现，因为违反了[保持程序目录纯净](/misc/norm.md#保持程序目录纯净)规范

如果需要加载器额外对某个文本文件中的 `_retinue\xxx` 引用进行动态替换，可以[在 `Script` 类型的步骤中使用 `fix` 字段](/reference/Steps.md#script)指定需要处理的文件；此时使用激进的替换策略，会替换所有可能是对 `_retinue` 目录内容引用的字段: `_retinue/`  `_retinue\` `./_retinue/`  `.\_retinue\`
:::

## 补丁文件夹
`_patch`

此文件夹用于存放一些需要替换或补充的文件，可以是对系统文件的补充，或是对程序本体的替换（由于[保持程序目录纯净](/misc/norm.md#保持程序目录纯净)规范的存在，你不能将补丁直接放在 `PackageName` 目录中）

使用时请使用 [`Move` 步骤](/reference/Steps.md#move)完成补充，加载器会自动将其识别为补丁操作，例如：

```toml
[setup_flow.patch]
name = "Patch"
type = "Move"

source = "./_patch/config/*"
target = "${SystemDrive}/Users/Config/"
overwrite = false
```

:::tip 与随从文件夹的区别
此文件夹专门用于存放*需要替换或补充的文件*，而不是被脚本引用的文件。
:::